# pedestrian detection at 100 fps [VeryFast]

this markdown file is about the configuration of the source code "doppia", affiliated with the paper "Pedestrian detection at 100 fps", CVPR2012, Rodrigo Benenson.

## platform
necessary platform: Linux+Cuda+GCC
My configuration: Fedora23+Cuda7.5+GCC5.3

## tools
mercurial, for `hg` command
cmake
ccmake
protobuf
protobuf-devel

## libs
boost
boost-devel
libjpeg
libpng

## errors and solus
### `int_p_NULL`
the compiler complains that: `int_p_NULL` was not declared in this scope.
that's caused by the new version of libpng since1.4

```
vim GroundEstimationGui.cpp +24
```
add this before inclusion `#include <boost/gil/extension/io/png_io.hpp>`
```
#define int_p_NULL (int*)NULL
```

also:
```
vim ~/workspace/100fps/doppia/src/applications/BaseSdlGui.cpp +16
vim ~/workspace/100fps/doppia/src/applications/BaseApplication.cpp +9
vim ~/workspace/100fps/doppia/src/stereo_matching/AbstractStereoMatcher.cpp +10
vim ~/workspace/100fps/doppia/src/stereo_matching/ground_plane/GroundPlaneEstimator.cpp +15
vim ~/workspace/100fps/doppia/src/video_input/VideoFromFiles.cpp +13
```

### protobuf complain
>In file included from /home/chris/workspace/100fps/doppia/src/video_input/calibration/StereoCameraCalibration.cpp:8:0:
/home/chris/workspace/100fps/doppia/src/video_input/calibration/calibration.pb.h:17:2: 错误：#error This file was generated by an older version of protoc which is
 #error This file was generated by an older version of protoc which is
  ^

ref blog:http://blog.csdn.net/chenkjiang/article/details/15809407
just comment the macro content in `~/workspace/100fps/doppia/src/video_input/calibration/calibration.pb.h`
,like this:

```
1 // Generated by the protocol buffer compiler.  DO NOT EDIT!
2 // source: calibration.proto
3 
4 #ifndef PROTOBUF_calibration_2eproto__INCLUDED
5 #define PROTOBUF_calibration_2eproto__INCLUDED
6 
7 #include <string>
8 
9 #include <google/protobuf/stubs/common.h>
10 
11 //#if GOOGLE_PROTOBUF_VERSION < 2004000
12 //#error This file was generated by a newer version of protoc which is
13 //#error incompatible with your Protocol Buffer headers.  Please update
14 //#error your headers.
15 //#endif
16 //#if 2004001 < GOOGLE_PROTOBUF_MIN_PROTOC_VERSION
17 //#error This file was generated by an older version of protoc which is    
18 //#error incompatible with your Protocol Buffer headers.  Please
19 //#error regenerate this file with a newer version of protoc.
20 //#endif
```

#### protobuf complain2
>In file included from /home/chris/workspace/100fps/doppia/src/video_input/calibration/StereoCameraCalibration.cpp:8:0:
/home/chris/workspace/100fps/doppia/src/video_input/calibration/calibration.pb.h: 在成员函数‘void doppia_protobuf::CameraCalibration::set_name(const string&)’中:
/home/chris/workspace/100fps/doppia/src/video_input/calibration/calibration.pb.h:1710:17: 错误：‘kEmptyString’不是‘google::protobuf::internal’的成员
   if (name_ == &::google::protobuf::internal::kEmptyString) {

it complains that `kEmptyString` is not a member of `google::protobuf::internal`

ref:https://github.com/google/protobuf/issues/648
So, the solution is simple: change `kEmptyString` to `GetEmptyString()`. Lines should be modified include:
```
/home/chris/workspace/100fps/doppia/src/video_input/calibration/calibration.pb.h +1700
...

/home/chris/workspace/100fps/doppia/src/video_input/calibration/calibration.pb.cc
...

#f**k, this error is too much
```

#### protobuf complain1 again
again, remove  `GOOGLE_PROTOBUF_VERSION < 2004000` et.al macros:
```
/home/chris/workspace/100fps/doppia/src/helpers/data/DataSequenceHeader.pb.h
```

### CodeInputStream error
>error ‘class google::protobuf::io::CodedInputStream’ invalid use

just add:
```
#include <google/protobuf/io/coded_stream.h>
```
to src/helpers/data/DataSequence.h

### boost library problem
`mt` means `multithread` in boost1.39. But fedora23, boost1.5, there is no postfix like `mt`,so:

libraries like `boost_program_options-mt` should be modified, remove `-mt`


